[
["index.html", "Differential Equations for ecologists Prerequisites", " Differential Equations for ecologists McCann Lab 2018-07-12 Prerequisites This book was generated using bookdown (Xie 2015), Yinhui Xie did an amazing job to document his work and to provide a very helpful minimal example at https://github.com/rstudio/bookdown-demo. R packages used throughout the book: library(latex2exp) library(odeintr) https://www.youtube.com/watch?v=kjBOesZCoqc&amp;list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab References "],
["intro.html", "Chapter 1 Introduction 1.1 What is this documemt for? 1.2 What is covered?", " Chapter 1 Introduction 1.1 What is this documemt for? A notebook about Differential Equations to gather note related to our meetings. 1.2 What is covered? "],
["overview.html", "Chapter 2 Brief history of dynamical systems theory 2.1 Early development 2.2 Ref - Ecology 2.3 Choose your computational tools", " Chapter 2 Brief history of dynamical systems theory http://www.scholarpedia.org/article/History_of_dynamical_systems 2.1 Early development Generalization of the tangent. P. de Fermat (1607-1665) I. Barrow (1630-1677) I. Newton (1642-1727) G. W. Leibnitz (1646-1716) B. Taylor (1685-1731) L. Euler (1707-1783) First to solve differential equation first order (1739) J-L. Lagrange (1736-1813) Riccati equation https://en.wikipedia.org/wiki/Riccati_equation 2.1.1 Limit concept J. L. Cauchy (1789-1857), K. T. W. Weierstrass (1815-1897) et R. Lipschitz (1832-1903) 2.1.2 Using geometry L. I. Fuchs (1833-1902) H. Poincaré (1854-1912), Stephen Smale https://en.wikipedia.org/wiki/Stephen_Smale (1930 -) Birkhoff This was a big step forwards to find solutions even for complex system (using differential geometry). But things got a bit more tricky when chaos was discover. 2.1.3 Chaos A. Turing (1912-1954) E. Lorenz (1907-2008) Li Lyapunov 2.1.3.1 Structural stability and catastrophe theory R. Thom (1923-2002) E. C. Zeeman FRS (1925 – 2016) A. Andronov (1901-1952) L. Pontryagin (1908-1988).} 2.1.4 Foliation https://en.wikipedia.org/wiki/Foliation C. Ehresmann (1905-1979) G. H. Reeb (1920-1993) 2.1.5 Ref - Math Lyapunov AM (1992) The general problem of the stability of motion. International Journal of Control 55 :531–534. Tao T, Vu V, Krishnapur M (2010) Random matrices : Universality of esds and the circular law. The Annals of Probability 38 :2023–2065. Stoll A (1998) Tangente à une courbe : résoudre des problèmes par le nouvement. Repères - IREM 30 :95–109. Lorenz EN (1963) Deterministic nonperiodic flow. Journal of the Atmospheric Sciences 20 :130–141. Li Ty, Yorke JA (1975) Period three implies chaos. The American Mathematical Monthly 82 :985. 4 Logofet DO (2005) Stronger-than-lyapunov notions of matrix stability, or how “flowers” help solve problems in mathematical ecology. Linear Algebra and its Applications 398 :75–100. Tao T, Vu VAN (1991) Random matrices : the circular law. pp 1–46. 2.2 Ref - Ecology Volterra V (1926) Fluctuations in the abundance of a species considered mathematically. Nature 118 :558–560. Elton C, Nicholson M (1942) The ten-year cycle in numbers of the lynx in canada. The Journal of Animal Ecology 11 :215. Gause G (1932) Experimental studies on the struggle for existence i. mixed population of two species of yeast. Journal of Experimental Biology 9 :389–402. Gardner MR, Ashby WR (1970) Connectance of large dynamic (cybernetic) systems : Critical values for stability. Nature 228 :784–784. Holling CS (1959) The components of predation as revealed by a study of small-mammal predation of the european pine sawfly. May RM (1972) Will a large complex system be stable ? Nature 238 :413–414. Allesina S, Tang S (2012) Stability criteria for complex ecosystems. Nature 483 :205–8. Rohr RP, Saavedra S, Bascompte J (2014) On the structural stability of mutualistic systems. Science 345 :1253497–1253497. GF Fussmann et al. (2000), “Crossing the Hopf Bifurcation in a Live Predator-Prey System” Costantino R, Desharnais R, Cushing J, Dennis B (1997) Chaotic dynamics in an insect population. Science (New York, N.Y.) 275 :389–91. 4 McCann KS (2000) The diversity-stability debate. Nature 405 :228–33. 9, 10, 13 31 Montoya JM, Woodward G, Emmerson MC, Solé RV (2009) Press perturbations and indirect effects in real food webs. Ecology 90 :2426–33. 10 Ives AR, Carpenter SR (2007) Stability and diversity of ecosystems. Science (New York, N.Y.) 317 :58–62. 10, 26 Bacaër N (2008) Histoire de mathématiques et de populations p 211. Caswell H, Neubert MG (2005) Reactivity and transient dynamics of discrete-time ecological systems. Journal of Difference Equations and Applications 11 :295–310. Pimm SL, Lawton JH (1978) On feeding on more than one trophic level. Nature 275 :542–544. 12 Yodzis P (1981) The stability of real ecosystems. Nature 289 :674–676 McCann K, Hastings A, Huxel GR (1998) Weak trophic interactions and the balance of nature. Nature 395 :794–798. 13 32 Berlow EL (1999) Strong effects of weak interactions in ecological communities. 13 Wootton JT (1994) The nature and consequences of indirect effects in ecological communi- ties. Annual Review of Ecology and Systematics 25 :443–466. 13 Rooney N, McCann K, Gellner G, Moore JC (2006) Structural asymmetry and the stability of diverse food webs. Nature 442 :265–9. 13 Schneider FD, Scheu S, Brose U (2012) Body mass constraints on feeding rates determine the consequences of predator loss. Ecology letters 15 :436–43. 13 Jackson JB, et al. (2001) Historical overfishing and the recent collapse of coastal ecosystems. Science (New York, N.Y.) 293 :629–37. 13 Estes Ja, et al. (2011) Trophic downgrading of planet earth. Science (New York, N.Y.) 333 :301–6. Ripple WJ, Beschta RL (2003) Wolf reintroduction, predation risk, and cottonwood recovery in yellowstone national park. Forest Ecology and Management 184 :299–313. Kéfi S, et al. (2007) Spatial vegetation patterns and imminent desertification in mediterranean arid ecosystems. Nature 449 :213–7. Allesina S, Tang S (2012) Stability criteria for complex ecosystems. Nature 483 :205–208. Tang S, Pawar S, Allesina S (2014) Correlation between interaction strengths drives stability in large ecological networks supporting information organization of the supporting informa- tion. 14 Brown JH, Gillooly JF, Allen AP, Savage VM, West GB (2004) Toward a metabolic theory of ecology. Ecology 85 :1771–1789. Thébault E, Fontaine C (2010) Stability of ecological communities and the architecture of mutualistic and trophic networks. Science (New York, N.Y.) 329 :853–6. Saavedra S, Stouffer DB, Uzzi B, Bascompte J (2011) Strong contributors to network persistence are the most vulnerable to extinction. Nature 478 :233–5. James A, Pitchford JW, Plank MJ (2012) Disentangling nestedness from models of ecological complexity. Nature 487 :227–30. 15 Saavedra S, Stouffer DB (2013) Disentangling nestedness&quot; disentangled. Nature 500 :E1–2. Kéfi S, et al. (2012) More than a meal. . . integrating non-feeding interactions into food webs. Ecology letters 15 :291–300. Tang S, Allesina S (2014) Reactivity and stability of large ecosystems. Frontiers in Ecology and Evolution 2 :1–8. Neubert MG, Caswell H (1997) Alternatives to resilience for measuring the responses of eco- logical systems to perturbations. Ecology 78 :653–665. Bastolla U, et al. (2009) The architecture of mutualistic networks minimizes competition and increases biodiversity. Nature 458 :1018–20. Säterberg T, Sellman S, Ebenman B (2013) High frequency of functional extinctions in ecolo- gical networks. Nature 499 :468–70. Knight TM, McCoy MW, Chase JM, McCoy Ka, Holt RD (2005) Trophic cascades across ecosystems. Nature 437 :880–3. Yoshida T, Jones LE, Ellner SP, Fussmann GF, Hairston NG (2003) Rapid evolution drives eco- logical dynamics in a predator-prey system. Nature 424 :303–6. 2.3 Choose your computational tools Among others: Julia: http://docs.juliadiffeq.org/latest/ Octave: https://octave.org/doc/v4.0.3/Ordinary-Differential-Equations.html Python: https://docs.scipy.org/doc/scipy-0.14.0/reference/generated/scipy.integrate.ode.html Rust: https://docs.rs/GSL/0.4.26/rgsl/types/ordinary_differential_equations/index.html FORTRAN C/C++ 2.3.1 R R: https://cran.r-project.org/web/packages/deSolve/index.html https://www.r-pkg.org/badges/version/odeintr 2.3.2 ODE with desolve deSolve package is commonly used to solve ODE. I recommend you start by looking at the vignettes https://cran.r-project.org/web/packages/deSolve/vignettes/compiledCode.pdf https://cran.r-project.org/web/packages/deSolve/vignettes/deSolve.pdf "],
["mathematical-prerequisites.html", "Chapter 3 Mathematical prerequisites 3.1 Notations 3.2 Equations 3.3 Change of the basis 3.4 Eigen value", " Chapter 3 Mathematical prerequisites 3.1 Notations 3.1.1 Sets \\(\\mathbb{N}\\): set of natural numbers \\(\\mathbb{R}\\): set of real number \\(\\mathbb{C}\\): set of imaginary number \\(\\mathbb{K}\\): either \\(\\mathbb{R}\\) or \\(\\mathbb{C}\\) 3.1.2 Matrices \\(0_n\\) null matrix, dimension \\(n\\) \\(I_n\\) identity matrix, dimension \\(n\\) eigen value eigen vectors trace determinant close or open circle spiral outward / inward / center seqx &lt;- seq(0, 1, .01) plot(seqx, se) 3.2 Equations 3.2.1 Order 2 3.2.1.1 General equation \\[ ax^2 + bx + c = 0 \\] where \\(a, b, c\\) are real numbers. 3.2.1.2 Solution \\[(S) \\iff x^2 + \\frac{b}{a}x + \\frac{c}{a} = 0\\] \\[(S) \\iff \\left( x + \\frac{b}{2a} \\right)^2 - \\left(\\frac{b}{a}\\right)^2 + \\frac{c}{a} = 0\\] \\[(S) \\iff \\left( x + \\frac{b}{2a} \\right)^2 - \\left(\\frac{b}{2a}\\right)^2 + \\frac{c}{a} = 0\\] \\[(S) \\iff \\left( x + \\frac{b}{2a} \\right)^2 - \\frac{b^2 + 4ac}{4a^2} = 0\\] \\[(S) \\iff \\left( x + \\frac{b}{2a} \\right) = \\pm \\frac{\\sqrt{b^2 + 4ac}}{2a} = 0\\] So: \\[x = \\frac{-b \\pm \\sqrt{b^2 + 4ac}}{2a} \\] Note that \\(b^2 + 4ac\\) is called the discriminant. 3.2.1.3 Example: the golden ratio Never heard about it? Have a look at the wikipedia page So basically the golden ration verifies: \\[ \\frac{b}{a+b} = \\frac{a}{b} \\] which is equivalent to: \\[ b^2 - ab - a^2 = 0 \\] Let’s assume \\(a = 1\\) and we are looking for \\(b\\), solutions are then: \\[ b^2 - b - 1 = 0 \\] \\[ b = \\frac{1 \\pm \\sqrt{5}}{2} \\] The positive solution is the golden ratio! 3.3 Change of the basis 3.4 Eigen value 3.4.1 Trick in 2 D lamda1 + lamda2 = trace lamba1 lambda2 = determinate 3.4.2 Ressources CHAOS A MATHEMATICAL ADVENTURE: http://www.chaos-math.org/en Essence of linear algebra on youtube: https://www.youtube.com/watch?v=kjBOesZCoqc&amp;list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab "],
["continuous-ode-in-one-dimension.html", "Chapter 4 Continuous ODE in one dimension 4.1 General terminology 4.2 Linear case 4.3 Study case", " Chapter 4 Continuous ODE in one dimension 4.1 General terminology \\[\\frac{dx}{dt} = \\dot{x} = x&#39; = f(x,t, \\Theta)\\] where: x is a state variable (e.g. a population of one species) t stands for time Θ includes all the parameters f is a transformation 4.2 Linear case \\[ \\left\\{ \\begin{array}{l} {dx \\over dt} = ax,\\\\ x(0) = x_0 \\end{array} \\right. \\] where \\(a\\) is a real number. Note that here Θ = a. Phase portrait star nodes non-isolated fixed points stable node saddle node different rates non-trivial equilibrium sometimes called interior 4.3 Study case Use local stability analysis on the logistic (all equilibria) and analytically calculate lambda. What is the stability response to r? For the following Budworm model done by D. Ludwig, \\[\\frac{dN}{dt} = rN\\left(1-\\frac{N}{K}\\right) - \\frac{BN^2}{N^2 + N_0}\\] where the budworm, N, grows logistical but is consumed by a constant amount of predators (density B). Using dynamical systems theory: i) find local equilibria for K and B (assume r=1); ii) solve for the local stability of all relevant equilibria as a function of budworm carrying capacity, K, and the predator density, B. What bifurcations do we expect and when? Hint: for insight it may help to do this graphically (and produce code dN/dt to check) consider the growth function (logistic term: rN(1-N/K)) and the mortality function (– BN2/(N2+No)) separately (i.e., note that where the growth function crosses the mortality function we have equilibria: plotting N versus these rates or terms of F(N) may therefore be useful). 4.3.1 Expanding the equation Non trivial equilibrium: \\[rN\\left(1-\\frac{N}{K}\\right) = \\frac{BN^2}{N^2 + N_0}\\] or simply: \\[r\\left(1-\\frac{N}{K}\\right) = \\frac{BN}{N^2 + N_0}\\] this yields: \\[-\\frac{r}{K}N^3 + rN^2 + \\left(r\\frac{N_0}{K}-B\\right)N - rN_0 = 0\\] let’s divide by \\(\\frac{r}{K}\\): \\[-N^3 + KN^2 + \\left(N_0-K\\frac{B}{r}\\right)N - KN_0 = 0\\] Assuming \\(r = 1\\), \\(K = 10\\), Below are shown this curve for station seqN &lt;- seq(-2, 12, .1) pol &lt;- function(N, r, K, B, N0) { if (!B) { # attack term does not exits out &lt;- K*N-N*N } else { if (!N0) { out &lt;- K*N-N*N - B } else out &lt;- -N^3 + K*N*N + (N0-K*(B/r))*N + - K*N0 } out } ## cust_plot &lt;- function(seqN, r, K, B, N0, main) { plot(seqN, pol(seqN, r, K, B, N0), type = &quot;l&quot;, lwd = 2, main = main, xlab = &quot;N&quot;, ylab = TeX(&quot;\\\\dot{N}&quot;)) abline(h=0, v=c(0,10), lty=2) } cust_plot(seqN, -1, 10, 0, 0, main = &quot;B = 0&quot;) cust_plot(seqN, -1, 10, 10, 0, main = &quot;B = 5; N0 = 0&quot;) cust_plot(seqN, -1, 10, 1, 2, main = &quot;B = 1; N0 = 2&quot;) cust_plot(seqN, -1, 10, 1, 4, main = &quot;B = 1; N0 = 4&quot;) cust_plot(seqN, -1, 10, 1, 8, main = &quot;B = 1; N0 = 8&quot;) "],
["ode-in-multi-dimensions.html", "Chapter 5 ODE in multi-dimensions 5.1 Terminology 5.2 Linear system 5.3 Non-Linear systems 5.4 Examples", " Chapter 5 ODE in multi-dimensions 5.1 Terminology \\[\\dot{X} = f(X, t, \\Theta)\\] where: X is a vector of state variables (e.g. population size of several species) t stands for time Θ includes all the parameters f is a multi-dimensional function 5.2 Linear system Function f and its parameters \\theta. 5.2.1 General case \\[ \\left\\{ \\begin{array}{l} \\dot{x}_1 = \\sum_i a_{1,i}x_i\\\\ ... \\\\ \\dot{x}_n = \\sum_i a_{n,i}x_{i} \\\\ X(0) = X_0 \\end{array} \\right. \\] Using matrices: \\[\\dot{X} = AX\\] Linear system in \\(n\\) dimensions. 5.2.2 Trivial case If \\(i \\neq j \\Rightarrow 0\\) then A in diagonal: \\[ \\left\\{ \\begin{array}{l} \\dot{x}_1 = a_{1,1}x_1\\\\ ... \\\\ \\dot{x}_n = a_{1,1}x_{n} \\\\ X(0) = X_0 \\end{array} \\right. \\] Then, all state variables are independent and the answer is obtained by solving \\(n\\) times a one-dimensional problem (described in the previous chapter). 5.2.3 Diagonalizations Now let’s go back to the general case and assume that A is a diagonalizable matrix (see Diagonalization on wikipedia), i.e. that it exits: \\(P\\) and \\(D\\) such as: \\[A = PDP^{-1}\\] This operation is a change of basis, we actually assume that it exists a basis in which our problem is as simple as the trivial case, \\(P\\) is the matrix that does the conversion. If our 5.2.4 Graphical examples beta &lt;- list( matrix(c(-1, 0, 0, -1), 2), matrix(c(1, 0, 0, -1), 2), matrix(c(-1, 0, 0, 1), 2), matrix(c(1, 0, 0, 1), 2) ) par(mfrow = c(2,2)) for (i in 1:4) intLinear(beta = beta[[i]]) beta &lt;- list( matrix(c(0, -1, -1, 1), 2), matrix(c(0, 1, -1, 0), 2), matrix(c(0, -1, 1, 0), 2), matrix(c(0, 1, 1, 0), 2) ) par(mfrow = c(2,2)) for (i in 1:4) intLinear(beta = beta[[i]]) beta &lt;- list( matrix(c(0, 1, -1, -1), 2), matrix(c(0, 1, -1, 1), 2), matrix(c(1, 1, -1, 1), 2), matrix(c(-1, 1, -1, 1), 2) ) par(mfrow = c(2,2)) for (i in 1:4) intLinear(beta = beta[[i]]) beta &lt;- list( matrix(c(0, 1, -1, -2), 2), matrix(c(0, 1, -1, -1), 2), matrix(c(0, 1, -1, -.5), 2), matrix(c(0, 1, -1, -.1), 2) ) par(mfrow = c(2,2)) for (i in 1:4) intLinear(beta = beta[[i]], mxt =100) beta &lt;- list( matrix(c(0, 2, -1, -.1), 2), matrix(c(0, 1, -1, -.1), 2), matrix(c(0, .5, -1, -.1), 2), matrix(c(0, .1, -1, -.1), 2) ) par(mfrow = c(2,2)) for (i in 1:4) intLinear(beta = beta[[i]], mxt =100) 5.3 Non-Linear systems 5.3.1 Finding the eigen values \\[AX = \\lambda X\\] Solutions of: \\[\\left(A - \\lambda I_n\\right) X = 0_n\\] 5.4 Examples Symetry drives weird shit! (K. S. McCann) 5.4.1 Lotka Volterra 5.4.1.1 Intro Classical model see Volterra (1927). Equations: \\[ \\left\\{ \\begin{array}{l} \\dot{R} = rR - aCR \\\\ \\dot{C} = eaCR - mC \\end{array} \\right. \\] 5.4.1.2 First find equilibria and isolclines \\[ \\left\\{ \\begin{array}{l} \\dot{R} = 0 \\Leftrightarrow C = r/a; C*=r/a \\\\ \\dot{C} = 0 \\Leftrightarrow R = m/(ea); R* = m/(ea) \\end{array} \\right. \\] 5.4.1.3 Jacobian matrix \\[\\begin{pmatrix} r-aC* &amp; -aR* \\\\ eaC* &amp; eaR*-m \\end{pmatrix}\\] at the non-trivial equilibrium: \\[\\begin{pmatrix} 0 &amp; -aR* \\\\ eaC* &amp; 0 \\end{pmatrix}\\] 5.4.1.4 Diagonalisation \\[\\begin{pmatrix} -\\lambda &amp; -aR* \\\\ eaC* &amp; -\\lambda \\end{pmatrix}\\] To get the two eigen values we must solve: \\[\\lambda^2 + mr = 0\\] \\[eig = \\pm i \\sqrt{mr}\\] (pure imaginary, so =&gt; spins) 5.4.1.5 Lotka-Volterra withodeintr odeint is a C++ library, Timothy H. Keitt (may ring the bell to some of you) has created a R package that wrapps around this library: odeintr. Example from the GitHub project page: library(odeintr) dxdt = function(x, t) c(x[1] - x[1] * x[2], x[1] * x[2] - x[2]) obs = function(x, t) c(Prey = x[1], Predator = x[2], Ratio = x[1] / x[2]) system.time({x = integrate_sys(dxdt, rep(2, 2), 20, 0.01, observer = obs)}) #&gt; user system elapsed #&gt; 1.484 0.008 1.489 plot(x[, c(2, 3)], type = &quot;l&quot;, lwd = 2, col = &quot;steelblue&quot;, main = &quot;Lotka-Volterra Phase Plot&quot;) 5.4.2 Rozenzweig-McArthur model 5.4.2.1 Into Another clasical, see Rosenzweig and MacArthur (1963) and Rosenzweig (1971) and McCann’s book! \\[ \\left\\{ \\begin{array}{l} \\dot{R} = rR(1-\\frac{R}{K}) - \\frac{aCR}{R+R0} \\\\ \\dot{C} = \\frac{eaCR}{R+R0} - mC \\end{array} \\right. \\] References "],
["chaos.html", "Chapter 6 About Chaos", " Chapter 6 About Chaos "],
["references.html", "References", " References "]
]
