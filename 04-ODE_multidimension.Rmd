# ODE in two dimensions and more

## General terminology

$$\dot{X} = f(X, t, \Theta)$$

where:

- `X` is a vector of state variables (*e.g.* population size of several species)
- `t` stands for time
- `Î˜` includes all the parameters
- `f` is a transformation



## Linear system

### General case

$$
\left\{
\begin{array}{l}
  \dot{x}_1 = \sum_i a_{1,i}x_i\\
  ... \\
  \dot{x}_n = \sum_i a_{n,i}x_{i} \\
  X(0) = X_0
\end{array}
\right.
$$

Using matrices:

$$\dot{X} = AX$$

Linear system in $n$ dimensions.

### Trivial case

If $i \neq j \Rightarrow 0$ then A in diagonal:


$$
\left\{
\begin{array}{l}
  \dot{x}_1 = a_{1,1}x_1\\
  ... \\
  \dot{x}_n = a_{1,1}x_{n} \\
  X(0) = X_0
\end{array}
\right.
$$

Then, all state variables are independent and the answer is obtained by solving
$n$ times a one-dimensional problem (described in the previous chapter).


### Diagonalization

Now let's go back to the general case and assume that A is a diagonalizable
matrix (see Diagonalization on [wikipedia](https://en.wikipedia.org/wiki/Diagonalizable_matrix#Diagonalization)),
*i.e.* that it exits: $P$ and $D$ such as:

$$A = PDP^{-1}$$

This operation is a [change of basis](https://en.wikipedia.org/wiki/Change_of_basis),
we actually assume that it exists a basis in which our problem is as simple as the trivial
case, $P$ is the matrix that does the conversion. If our


### Graphical examples

```{r loadlinear, echo = F}
<<linear>>
```

```{r linear1, fig.width = 9, fig.height = 8}
beta <- list(
  matrix(c(-1, 0, 0, -1), 2),
  matrix(c(1, 0, 0, -1), 2),
  matrix(c(-1, 0, 0, 1), 2),
  matrix(c(1, 0, 0, 1), 2)
)
par(mfrow = c(2,2))
for (i in 1:4) intLinear(beta = beta[[i]])
```



## Non-Linear system


### Finding the eigen values

$$AX = \lambda X$$

Solutions of:

$$\left(A - \lambda I_n\right) X  = 0_n$$




## Examples

### Lotka-Volterra with`odeintr`

[`odeint`](http://headmyshoulder.github.io/odeint-v2/) is a C++ library, Timothy H. Keitt (may ring the bell to some of you)
has created a R package that wrapps around this library: [odeintr](https://github.com/thk686/odeintr).

Example from the GitHub project page:


```{r}
library(odeintr)
dxdt = function(x, t) c(x[1] - x[1] * x[2], x[1] * x[2] - x[2])
obs = function(x, t) c(Prey = x[1], Predator = x[2], Ratio = x[1] / x[2])
system.time({x = integrate_sys(dxdt, rep(2, 2), 20, 0.01, observer = obs)})
plot(x[, c(2, 3)], type = "l", lwd = 2, col = "steelblue", main = "Lotka-Volterra Phase Plot")
```
